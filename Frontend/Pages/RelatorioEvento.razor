@page "/RelatorioEvento"

@using System.Collections.Generic

<h3>Search Event</h3>

<div class="search-event-container">
    <div class="form-group">
        <label for="search">Search:</label>
        <input id="search" class="form-control" @bind="SearchText" />
    </div>

    <div class="form-group">
        <button class="btn btn-primary" @onclick="SearchEventoAsync">Search</button>
    </div>

    @if (eventos != null && eventos.Any())
    {
        <h4>Search Results:</h4>

        <ul>
            @foreach (var evento in eventos)
            {
                <li>@evento.Capacidade
                    @evento.Preco</li>
            }
        </ul>
    }
    else if (isSearching)
    {
        <p>Loading...</p>
    }
    else if (searched)
    {
        <p>No events found.</p>
    }
</div>

<style>
    /* Styles here */
</style>

@code {
    private string SearchText { get; set; }
    private List<Evento> eventos;
    private bool isSearching;
    private bool searched;

    public class Evento
    {
        public int? Capacidade { get; set; }
        public decimal? Preco { get; set; }
       
    }

    [Inject]
    private HttpClient httpClient { get; set; }

    private async Task SearchEventoAsync()
    {
        isSearching = true;
        searched = false;

        var url = $"http://localhost:5052/api/Eventos/search?search={SearchText}";
        eventos = await httpClient.GetFromJsonAsync<List<Evento>>(url);

        isSearching = false;
        searched = true;
    }
}